---
title: 对象数据格式转化
date: 2019-08-15 15:07:04
tags:
---
两种数据格式间相互转换
```javascript
var entry = {
  'a.b.c.dd': 'abcdd',
  'a.d.xx': 'adxx',
  'a.e': 'ae'
};

var output = {
  a: {
   b: {
     c: {
       dd: 'abcdd'
     }
   },
   d: {
     xx: 'adxx'
   },
   e: 'ae'
  }
};
```

<!-- more -->

解法：
```javascript
function entryToOutput(entry) {
    const result = {}
    const keys = Object.keys(entry)
    for(let key of keys) {
        const keysArr = key.split('.');
        keysArr.reduce((prev, next, index, array) => {
            if(index === array.length - 1){
                prev[next] = entry[key]
                return;
            }
            prev[next] = prev[next] || {}
            return prev[next];
        }, result)
    }
    return result;
}

function outputToEntry(output, parentKey = '', result = {}) {
   for(let key in output) {
       if(output.hasOwnProperty(key)) {
           const keyName = `${parentKey}${key}`;
           if(typeof output[key] === 'object'){
               outputToEntry(output[key], `${keyName}.`, result)
           }else{
               result[keyName] = output[key];
           }
       }
   } 
   return result;
}

console.log(entryToOutput(entry))
console.log(outputToEntry(output))
```